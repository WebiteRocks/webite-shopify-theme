<section class="uk-position-relative uk-visible-toggle uk-light uk-slideshow" 
        uk-slideshow="min-height: {{ section.settings.min_height }}; max-height: {{ section.settings.max_height }}; animation: {{ section.settings.animation }}; autoplay: {{ section.settings.autoplay }}; pause-on-hover: {{ section.settings.pause_on_hover }};">
    <ul class="uk-slideshow-items" style="min-height: {{ section.settings.min_height }}px;">
        {%- for block in section.blocks -%}
            {%- if block.settings.image != blank -%}
                <li style="background-color: {{ block.settings.background_color }}" class="{% if forloop.first %}uk-active uk-transition-active{% endif %}" {{ block.shopify_attributes }}>
                    {%- if block.settings.link_url != blank -%}
                        <a href="{{ block.settings.link_url }}">
                    {%- endif -%}
                    <figure class="uk-container uk-height-1-1">
                        {% render 'image', image: block.settings.image,
                            image_class: "uk-cover",
                            max_width: block.settings.image.width | default: 1200,
                            max_height: block.settings.image.height | default: 800,
                            sizes: "(min-width: 1200px) 1200px, 100vw",
                            widths: "480, 720, 1200, 1800",
                            loading: block.settings.image_loading,
                            attributes: 'uk-cover alt="{{ block.settings.image.alt | default: block.settings.heading }}"'
                        %}
                        
                        {%- if block.settings.show_overlay -%}
                            <div class="uk-overlay uk-position-center uk-text-center">
                                {%- if block.settings.heading != blank -%}
                                    <h2 class="uk-heading-medium">{{ block.settings.heading }}</h2>
                                {%- endif -%}
                                {%- if block.settings.subheading != blank -%}
                                    <p class="uk-text-lead">{{ block.settings.subheading }}</p>
                                {%- endif -%}
                                {%- if block.settings.button_text != blank and block.settings.button_link != blank -%}
                                    <a class="uk-button uk-button-primary" href="{{ block.settings.button_link }}">{{ block.settings.button_text }}</a>
                                {%- endif -%}
                            </div>
                        {%- endif -%}
                    </figure>
                    {%- if block.settings.link_url != blank -%}
                        </a>
                    {%- endif -%}
                </li>
            {%- endif -%}
        {%- endfor -%}
    </ul>

    {%- if section.settings.show_navigation and section.blocks.size > 1 -%}
        <a class="uk-position-center-left uk-position-small uk-hidden-hover uk-slidenav-previous uk-icon uk-slidenav" href="#" uk-slideshow-item="previous" uk-slidenav-previous=""></a>
        <a class="uk-position-center-right uk-position-small uk-hidden-hover uk-slidenav-next uk-icon uk-slidenav" href="#" uk-slideshow-item="next" uk-slidenav-next=""></a>
    {%- endif -%}

    {%- if section.settings.show_dots and section.blocks.size > 1 -%}
        <div class="uk-position-bottom-center uk-position-small">
            <ul class="uk-slideshow-nav uk-dotnav"></ul>
        </div>
    {%- endif -%}
</section>

{% schema %}
{
  "name": "Slideshow",
  "class": "section-slideshow",
  "tag": "section",
  "settings": [
    {
      "type": "header",
      "content": "Slideshow settings"
    },
    {
      "type": "range",
      "id": "min_height",
      "min": 300,
      "max": 1000,
      "step": 50,
      "default": 600,
      "unit": "px",
      "label": "Minimum height"
    },
    {
      "type": "range",
      "id": "max_height",
      "min": 400,
      "max": 1200,
      "step": 50,
      "default": 800,
      "unit": "px",
      "label": "Maximum height"
    },
    {
      "type": "select",
      "id": "animation",
      "options": [
        {
          "value": "slide",
          "label": "Slide"
        },
        {
          "value": "fade",
          "label": "Fade"
        },
        {
          "value": "scale",
          "label": "Scale"
        },
        {
          "value": "pull",
          "label": "Pull"
        },
        {
          "value": "push",
          "label": "Push"
        }
      ],
      "default": "slide",
      "label": "Animation"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "default": true,
      "label": "Autoplay slideshow"
    },
    {
      "type": "checkbox",
      "id": "pause_on_hover",
      "default": true,
      "label": "Pause on hover"
    },
    {
      "type": "checkbox",
      "id": "show_navigation",
      "default": true,
      "label": "Show navigation arrows"
    },
    {
      "type": "checkbox",
      "id": "show_dots",
      "default": true,
      "label": "Show dots navigation"
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "color",
          "id": "background_color",
          "label": "Background color",
          "default": "#000000"
        },
        {
          "type": "select",
          "id": "image_loading",
          "label": "Image loading",
          "options": [
            {
              "value": "lazy",
              "label": "Lazy load (better performance)"
            },
            {
              "value": "eager",
              "label": "Eager load (immediate loading)"
            }
          ],
          "default": "lazy",
          "info": "Lazy loading improves performance but use eager loading for above-the-fold slides"
        },
        {
          "type": "url",
          "id": "link_url",
          "label": "Slide link"
        },
        {
          "type": "header",
          "content": "Content overlay"
        },
        {
          "type": "checkbox",
          "id": "show_overlay",
          "default": false,
          "label": "Show overlay content"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Image slide"
        },
        {
          "type": "text",
          "id": "subheading",
          "label": "Subheading"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button text"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Slideshow",
      "category": "Carousels",
      "blocks": [
        {
          "type": "slide"
        },
        {
          "type": "slide"
        }
      ]
    }
  ]
}
{% endschema %}
